#########################################################################################
#
# The Prince and the Thane war & battle events - written by idib816, jordarkelf and Galle
#
#########################################################################################

### Pre-Battlefield-Duel Events
# battlefield_duel.0	Begin Battlefield Duel Chain
# battlefield_duel.1	Defender: Fight or Run?
# battlefield_duel.2	Attacker: Fight or Run? (Begin Duel)
# battlefield_duel.3	Defender Runs
# battlefield_duel.4	Attacker Runs
### Post-Battlefield-Duel Events
# battlefield_duel.5	(End Duel) Victor Killed Opponent
# battlefield_duel.6	(End Duel) Victor Takes Opponent Hostage
# battlefield_duel.7	Opponent Imprisoned

namespace = battlefield_duel

character_event = { # Battlefield Duel Start
	id = battlefield_duel.0
	desc = "EVTDESCbattlefield_duel.0"
	border = "GFX_event_normal_frame_war"
	picture = GFX_evt_battle
	
	is_triggered_only = yes
	
	trigger = {
		# Avoid crossing targets
		any_current_enemy = {
			at_location = ROOT
			in_command = yes
			NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } }
			}
		}
	}
	
	mean_time_to_happen = { #on_action, multiplies with chance there
		days = 3
		modifier = {
			factor = 1.5
			trait = trained_warrior
		}
		modifier = {
			factor = 1.75
			trait = skilled_warrior
		}
		modifier = {
			factor = 2
			trait = master_warrior
		}
		modifier = {
			factor = 3
			trait = duelist
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			martial = 10
		}
		modifier = {
			factor = 2.0
			martial = 15
		}
		modifier = {
			factor = 2.5
			martial = 20
		}
	}
	
	immediate = {
		# Target lock
		random_current_enemy = {
			limit = {
				at_location = ROOT
				in_command = yes
				NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			}
			opinion = { who = ROOT modifier = opinion_battle_duel_target }
			reverse_opinion = { who = ROOT modifier = opinion_battle_duel_target }
		}
	}
	
	option = {
		name = "EVTOPTAbattlefield_duel.0"
		random_current_enemy = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_battle_duel_target } }
			hidden_tooltip = { character_event = { id = battlefield_duel.1 } }
		}
	}
}

character_event = {
	id = battlefield_duel.1
	desc = "EVTDESCbattlefield_duel.1"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	immediate = {
		# Remove targeting information
		remove_opinion = { who = FROM modifier = opinion_battle_duel_target }
		reverse_remove_opinion = { who = FROM modifier = opinion_battle_duel_target }
	}
	
	option = {
		name = "EVTOPTAbattlefield_duel.1"
		FROM = { character_event = { id = battlefield_duel.2 tooltip = "EVTTOOLTIPbattlefield_duel.2" } }
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				trait = poor_warrior
			}
			modifier = {
				factor = 3
				trait = trained_warrior
			}
			modifier = {
				factor = 4
				trait = skilled_warrior
			}
			modifier = {
				factor = 5
				trait = master_warrior
			}
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = strong
			}
		}
	}
	
	option = {
		name = "EVTOPTBbattlefield_duel.1"
		hidden_tooltip = { FROM = { character_event = { id = battlefield_duel.3 } } }
		if = {
			limit = { NOT = { trait = craven } }
			random = {
				chance = 25
				add_trait = craven
				hidden_tooltip = {
					character_event = { id = 38257 }
				}
			}
		}
		morale = -0.1
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				FROM = { trait = poor_warrior }
			}
			modifier = {
				factor = 3
				FROM = { trait = trained_warrior }
			}
			modifier = {
				factor = 4
				FROM = { trait = skilled_warrior }
			}
			modifier = {
				factor = 5
				FROM = { trait = master_warrior }
			}
			modifier = {
				factor = 2
				FROM = { trait = strong }
			}
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = weak
			}
			modifier = {
				factor = 2
				trait = dwarf
			}
			modifier = {
				factor = 2
				trait = hunchback
			}
			modifier = {
				factor = 2
				trait = leper
			}
			modifier = {
				factor = 2
				trait = wounded
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
			modifier = {
				factor = 4
				trait = maimed
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
			modifier = {
				factor = 10
				trait = blinded
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
		}
	}
}

character_event = {
	id = battlefield_duel.2
	desc = "EVTDESCbattlefield_duel.2"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.2"
		
		# Set context flags for duel
		set_character_flag = flag_battlefield_duel
		FROM = { set_character_flag = flag_battlefield_duel }
		
		# Begin duel
		hidden_tooltip = { e_rebels = { holder_scope = { character_event = { id = duel.1 } } } }
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				trait = poor_warrior
			}
			modifier = {
				factor = 3
				trait = trained_warrior
			}
			modifier = {
				factor = 4
				trait = skilled_warrior
			}
			modifier = {
				factor = 5
				trait = master_warrior
			}
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = strong
			}
		}
	}
	
	option = {
		name = "EVTOPTBbattlefield_duel.2"
		hidden_tooltip = { FROM = { character_event = { id = battlefield_duel.4 } } }
		if = {
			limit = { NOT = { trait = craven } }
			random = {
				chance = 25
				add_trait = craven
				hidden_tooltip = {
					character_event = { id = 38257 }
				}
			}
		}
		morale = -0.1
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				FROM = { trait = poor_warrior }
			}
			modifier = {
				factor = 3
				FROM = { trait = trained_warrior }
			}
			modifier = {
				factor = 4
				FROM = { trait = skilled_warrior }
			}
			modifier = {
				factor = 5
				FROM = { trait = master_warrior }
			}
			modifier = {
				factor = 2
				FROM = { trait = strong }
			}
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = weak
			}
			modifier = {
				factor = 2
				trait = dwarf
			}
			modifier = {
				factor = 2
				trait = hunchback
			}
			modifier = {
				factor = 2
				trait = leper
			}
			modifier = {
				factor = 2
				trait = wounded
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
			modifier = {
				factor = 4
				trait = maimed
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
			modifier = {
				factor = 10
				trait = blinded
				NOT = { trait = lunatic }
				NOT = { trait = brave }
				NOT = { trait = proud }
				NOT = { trait = wroth }
			}
		}
	}
}

character_event = {
	id = battlefield_duel.3
	desc = "EVTDESCbattlefield_duel.3"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.3"
		morale = 0.1
	}
}

character_event = {
	id = battlefield_duel.4
	desc = "EVTDESCbattlefield_duel.4"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.4"
		morale = 0.1
	}
}

# Battlefield duel end
character_event = {
	id = battlefield_duel.5
	desc = "EVTDESCbattlefield_duel.5"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.5"
		random_current_enemy = {
			limit = { at_location = ROOT }
			morale = -0.2
		}
	}
}

character_event = {
	id = battlefield_duel.6
	desc = "EVTDESCbattlefield_duel.6"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.6"
		hidden_tooltip = { FROM = { FROM = { character_event = { id = battlefield_duel.7 } } } }
	}
}

character_event = {
	id = battlefield_duel.7
	desc = "EVTDESCbattlefield_duel.7"
	picture = GFX_evt_battle
	border = "GFX_event_normal_frame_war"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAbattlefield_duel.7"
		imprison = FROM
		set_character_flag = war_prisoner
		hidden_tooltip = {
			FROM = {
				character_event = { 
					id = 50020 # "imprisoned_events.txt"
				}
			}
		}
	}
}

namespace = battle_events

#Battle improvement to martial skills

character_event = {
	id = battle_events.0
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_orlando"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = misguided_warrior
	}
	
	mean_time_to_happen = {
		days = 1
                modifier = {
			factor = 0.5
			trait = craven
		}
                modifier = {
			factor = 0.5
			trait = slothful
		}
                modifier = {
			factor = 0.5
			trait = poor_warrior
		}
                modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
                modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
                modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
                modifier = {
			factor = 1.25
			martial = 13
		}
                modifier = {
			factor = 1.25
			martial = 15
		}
                modifier = {
			factor = 1.25
			martial = 17
		}
                modifier = {
			factor = 1.25
			martial = 19
		}
                modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 1.35
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = misguided_warrior
		add_trait = tough_soldier
	}
}

character_event = {
	id = battle_events.1
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_melee3"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = tough_soldier
	}
	
	mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 1.35
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = tough_soldier
		add_trait = skilled_tactician
	}
}

character_event = {
	id = battle_events.2
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_melee3"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = skilled_tactician
	}
	
	mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 1.35
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = skilled_tactician
		add_trait = brilliant_strategist
	}
}

#Battle improvement to combat skills

character_event = {
	id = battle_events.3
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_battle_promotion"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = poor_warrior
	}
	mean_time_to_happen = {
		days = 2
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = poor_warrior
		add_trait = trained_warrior
	}
}

character_event = {
	id = battle_events.4
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_battle_promotion"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = trained_warrior
	}
	
	mean_time_to_happen = {
		days = 2
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = trained_warrior
		add_trait = skilled_warrior
	}
}

character_event = {
	id = battle_events.5
	title = "EVTNAMEbattle_events.0"
	desc = "EVTDESCbattle_events.0"
	picture = "GFX_evt_battle_promotion"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		trait = skilled_warrior
	}
	
	mean_time_to_happen = {
		days = 2
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
	}

	option = {
		name = "EVTOPTAbattle_events.0"
		remove_trait = skilled_warrior
		add_trait = master_warrior
	}
}

# Flat improvement to martial skill
character_event = {
	id = battle_events.6
	title = "EVTNAMEbattle_events.6"
	desc = "EVTDESCbattle_events.6"
	picture = "GFX_evt_melee3"
	border = GFX_event_normal_frame_war

	min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
		NOT = { martial = 15 }
	}
	
	mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 1.35
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
	}

	option = {
		name = "EVTOPTAbattle_events.6"		
		change_martial = 1
	}
}

#On-action combat event: combat prowess goes down
character_event = {
	id = battle_events.7
	
	picture = "GFX_evt_battle2"
	border = GFX_event_normal_frame_war

	desc = "My fighting skills were horrible in the last battle!"

        min_age = 14
	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes
	
	trigger = {
	    OR = {
		trait = master_warrior
		trait = skilled_warrior
		trait = trained_warrior
		}
	}
	
	mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.5
			trait = craven
		}
        modifier = {
			factor = 0.5
			trait = slothful
		}
        modifier = {
			factor = 0.5
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 0.5
			trait = brave
		}
		modifier = {
			factor = 0.5
			trait = skilled_tactician
		}
		modifier = {
			factor = 0.5
			trait = brilliant_strategist
		}
		modifier = {
			factor = 0.5
			trait = skilled_warrior
		}
		modifier = {
			factor = 0.5
			trait = master_warrior
		}
	}

	option = {
		name = "Damn!"
		trigger = { trait = master_warrior }
		remove_trait = master_warrior
		add_trait = skilled_warrior
	}
	
	option = {
		name = "Damn!"
		trigger = { trait = skilled_warrior }
		remove_trait = skilled_warrior
		add_trait = trained_warrior
	}
	option = {
		name = "Damn!"
		trigger = { trait = trained_warrior }
		remove_trait = trained_warrior
		add_trait = poor_warrior
	}
}

#On-action combat event: martial goes down
character_event = {
	id = battle_events.8
	is_triggered_only = yes
	
	picture = "GFX_evt_battle4"
	border = GFX_event_normal_frame_war

	desc = "My fighting skills were horrible in the last battle!"
	
	trigger = {
		NOT = { trait = brilliant_strategist }
		NOT = { trait = master_warrior }
        martial = 15
		is_alive = yes
	}
	
    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 1.5
			trait = craven
		}
        modifier = {
			factor = 2.5
			NOT = { martial = 8 }
		}
        modifier = {
			factor = 2.5
			NOT = { martial = 12 }
		}
        modifier = {
			factor = 1.5
			trait = slothful
		}
        modifier = {
			factor = 1.5
			trait = poor_warrior
		}
        modifier = {
			factor = 2.5
			age = 60
		}
		modifier = {
			factor = 0.5
			trait = brilliant_strategist
		}
		modifier = {
			factor = 0.5
			trait = master_warrior
		}
	}
	
	option = {
		name = "Dammit"
        prestige = -25
		change_martial = -1
	}
}

#On-action battle_lost: Imprisoned by the enemy
character_event = {
	id = battle_events.9
	is_triggered_only = yes
	
	picture = "GFX_evt_into_the_dungeon"
	border = GFX_event_normal_frame_war

	desc = "EVTDESC250"
	
	trigger = {
		is_alive = yes
		is_ruler = yes
		primary_title = { higher_tier_than = BARON }
		prisoner = no
		NOT = {
			character = FROM
		}
	}
	
	mean_time_to_happen = {
		days = 1

		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.25
			trait = paranoid
		}

		modifier = {
			factor = 1.25
			trait = stressed
		}
		modifier = {
			factor = 1.25
			trait = depressed
		}
		modifier = {
			factor = 1.5
			trait = lunatic
		}
		modifier = {
			factor = 1.5
			trait = possessed
		}
		modifier = {
			factor = 1.1
			trait = ill
		}
		modifier = {
			factor = 1.25
			trait = pneumonic
		}
		modifier = {
			factor = 1.25
			trait = syphilitic
		}
		modifier = {
			factor = 2.0
			trait = leper
		}
		modifier = {
			factor = 1.15
			trait = wounded
		}
		modifier = {
			factor = 1.25
			trait = maimed
		}
		modifier = {
			factor = 2.0
			trait = infirm
		}
		modifier = {
			factor = 3.0
			trait = incapable
		}
		modifier = {
			factor = 1.1
			trait = drunkard
		}
		modifier = {
			factor = 1.1
			trait = has_tuberculosis
		}
		modifier = {
			factor = 1.1
			trait = has_typhoid_fever
		}
		modifier = {
			factor = 1.5
			trait = has_typhus
		}
		modifier = {
			factor = 1.5
			trait = has_bubonic_plague
		}
		modifier = {
			factor = 1.1
			trait = has_measles
		}		
		modifier = {
			factor = 1.1
			trait = has_small_pox
		}
		
	}

	option = {
		name = "CURSES"
		set_character_flag = war_prisoner
		imprison = FROM
		hidden_tooltip = {
			FROM = {
				character_event = { 
					id = 50020 # "imprisoned_events.txt"
				}
			}
		}
	}
}

#On-action battle_lost: Imprisoned by the enemy
character_event = {
	id = battle_events.10
	is_triggered_only = yes
	
	picture = "GFX_evt_into_the_dungeon"
	border = GFX_event_normal_frame_war

	desc = "EVTDESC250"
	
	trigger = {
		is_alive = yes
		is_ruler = yes
		primary_title = { higher_tier_than = COUNT }
		prisoner = no
		NOT = {
			character = FROM
		}
	}
	
	mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 1.5
			trait = craven
		}
        modifier = {
			factor = 2.5
			NOT = { martial = 8 }
		}
        modifier = {
			factor = 2.5
			NOT = { martial = 12 }
		}
        modifier = {
			factor = 1.5
			trait = slothful
		}
        modifier = {
			factor = 1.5
			trait = poor_warrior
		}
        modifier = {
			factor = 1.5
			trait = kind
		}
        modifier = {
			factor = 0.5
			martial = 15
		}
        modifier = {
			factor = 0.75
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = skilled_tactician
		}
		modifier = {
			factor = 1.5
			trait = brilliant_strategist
		}
		modifier = {
			factor = 0.5
			trait = skilled_warrior
		}
		modifier = {
			factor = 0.5
			trait = master_warrior
		}
		
	}

	option = {
		name = "CURSES"
		imprison = FROM
		set_character_flag = war_prisoner
		hidden_tooltip = {
			FROM = {
				character_event = { 
					id = 50020 # "imprisoned_events.txt"
				}
			}
		}
	}
}

#On-action battle_lost: Imprisoned by the enemy
character_event = {
	id = battle_events.11
	is_triggered_only = yes
	
	picture = "GFX_evt_into_the_dungeon"
	border = GFX_event_normal_frame_war

	desc = "EVTDESC250"
	
	trigger = {
		is_alive = yes
		is_ruler = yes
		primary_title = { higher_tier_than = DUKE }
		prisoner = no
		NOT = {
			character = FROM
		}
	}
	
	mean_time_to_happen = {
		days = 1

		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.25
			trait = paranoid
		}

		modifier = {
			factor = 1.25
			trait = stressed
		}
		modifier = {
			factor = 1.25
			trait = depressed
		}
		modifier = {
			factor = 1.5
			trait = lunatic
		}
		modifier = {
			factor = 1.5
			trait = possessed
		}
		modifier = {
			factor = 1.1
			trait = ill
		}
		modifier = {
			factor = 1.25
			trait = pneumonic
		}
		modifier = {
			factor = 1.25
			trait = syphilitic
		}
		modifier = {
			factor = 2.0
			trait = leper
		}
		modifier = {
			factor = 1.15
			trait = wounded
		}
		modifier = {
			factor = 1.25
			trait = maimed
		}
		modifier = {
			factor = 2.0
			trait = infirm
		}
		modifier = {
			factor = 3.0
			trait = incapable
		}
		modifier = {
			factor = 1.1
			trait = drunkard
		}
		modifier = {
			factor = 1.1
			trait = has_tuberculosis
		}
		modifier = {
			factor = 1.1
			trait = has_typhoid_fever
		}
		modifier = {
			factor = 1.5
			trait = has_typhus
		}
		modifier = {
			factor = 1.5
			trait = has_bubonic_plague
		}
		modifier = {
			factor = 1.1
			trait = has_measles
		}		
		modifier = {
			factor = 1.1
			trait = has_small_pox
		}
		
	}

	option = {
		name = "CURSES"
		imprison = FROM
		set_character_flag = war_prisoner
		hidden_tooltip = {
			FROM = {
				character_event = { 
					id = 50020 # "imprisoned_events.txt"
				}
			}
		}
	}
}

#On-action battle_won: Become Knighted
character_event = {
	id = battle_events.12
	desc = "EVTDESCbattle_events.12"
	picture = "GFX_evt_knight1"
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		is_alive = yes
        independent = no
        NOT = { trait = knight }
		OR = {
		    religion = catholic
			is_heresy_of = catholic
		}
	}
	
	mean_time_to_happen = {
		days = 2
		modifier = {
			factor = 1.5
			trait = brave
		}		
		modifier = {
			factor = 1.5
			martial = 10
		}		

		modifier = {
			trait = genius
			factor = 1.2
		}
		modifier = {
			trait = quick
			factor = 1.1
		}	
		modifier = {
			trait = slow
			factor = 0.9
		}
		
		modifier = {
			trait = imbecile
			factor = 0.2
		}
		modifier = {
			trait = inbred
			factor = 0.2
		}
		modifier = {
			trait = strong
			factor = 1.5
		}
		modifier = {
			trait = weak
			factor = 0.8
		}	
				modifier = {
			factor = 0.8
			trait = stressed
		}
		modifier = {
			factor = 0.8
			trait = depressed
		}
		modifier = {
			factor = 0.75
			trait = lunatic
		}
		modifier = {
			factor = 0.75
			trait = possessed
		}
		modifier = {
			factor = 0.9
			trait = ill
		}
		modifier = {
			factor = 0.8
			trait = pneumonic
		}
		modifier = {
			factor = 0.8
			trait = syphilitic
		}
		modifier = {
			factor = 0.5
			trait = leper
		}
		modifier = {
			factor = 0.9
			trait = wounded
		}
		modifier = {
			factor = 0.8
			trait = maimed
		}
		modifier = {
			factor = 0.5
			trait = infirm
		}
		modifier = {
			factor = 0.4
			trait = incapable
		}
		modifier = {
			factor = 0.5
			trait = drunkard
		}
		modifier = {
			factor = 0.5
			trait = has_tuberculosis
		}
		modifier = {
			factor = 0.5
			trait = has_typhoid_fever
		}
		modifier = {
			factor = 0.5
			trait = has_typhus
		}
		modifier = {
			factor = 0.5
			trait = has_bubonic_plague
		}
		modifier = {
			factor = 0.5
			trait = has_measles
		}		
		modifier = {
			factor = 0.5
			trait = has_small_pox
		}

	}

	option = {
		name = "It's an honour"
		prestige = 50
        add_trait = knight
	}
}

#On-action battle_won: Becomes Squire
character_event = {
	id = battle_events.13
	desc = "EVTDESCbattle_events.13"
	picture = "GFX_evt_knight"
	border = GFX_event_normal_frame_war
    max_age = 20
	
	is_triggered_only = yes

	trigger = {
		is_alive = yes
        independent = no
        NOT = { 
		    OR = {  
			    trait = knight
                trait = squire 
			} 
		}
		
		OR = {
		    religion = catholic
			is_heresy_of = catholic
		}
	}
	
	mean_time_to_happen = {
		days = 3
		modifier = {
			factor = 1.5
			trait = brave
		}		
		modifier = {
			factor = 1.5
			martial = 10
		}		

		modifier = {
			trait = genius
			factor = 1.2
		}
		modifier = {
			trait = quick
			factor = 1.1
		}	
		modifier = {
			trait = slow
			factor = 0.9
		}
		
		modifier = {
			trait = imbecile
			factor = 0.2
		}
		modifier = {
			trait = inbred
			factor = 0.2
		}
		modifier = {
			trait = strong
			factor = 1.5
		}
		modifier = {
			trait = weak
			factor = 0.8
		}	
				modifier = {
			factor = 0.8
			trait = stressed
		}
		modifier = {
			factor = 0.8
			trait = depressed
		}
		modifier = {
			factor = 0.75
			trait = lunatic
		}
		modifier = {
			factor = 0.75
			trait = possessed
		}
		modifier = {
			factor = 0.9
			trait = ill
		}
		modifier = {
			factor = 0.8
			trait = pneumonic
		}
		modifier = {
			factor = 0.8
			trait = syphilitic
		}
		modifier = {
			factor = 0.5
			trait = leper
		}
		modifier = {
			factor = 0.9
			trait = wounded
		}
		modifier = {
			factor = 0.8
			trait = maimed
		}
		modifier = {
			factor = 0.5
			trait = infirm
		}
		modifier = {
			factor = 0.4
			trait = incapable
		}
		modifier = {
			factor = 0.5
			trait = drunkard
		}
		modifier = {
			factor = 0.5
			trait = has_tuberculosis
		}
		modifier = {
			factor = 0.5
			trait = has_typhoid_fever
		}
		modifier = {
			factor = 0.5
			trait = has_typhus
		}
		modifier = {
			factor = 0.5
			trait = has_bubonic_plague
		}
		modifier = {
			factor = 0.5
			trait = has_measles
		}		
		modifier = {
			factor = 0.5
			trait = has_small_pox
		}
	}

	option = {
		name = "It's an honour"
		prestige = 20
        add_trait = squire
	}
}

#On-action combat event: Character skill improves
character_event = {
	id = battle_events.14
	desc = "My fighting skills were horrible in the last battle!"
	picture = GFX_evt_battle
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	
	trigger = {
		is_alive = yes
		OR = {
			trait = tough_soldier
			trait = skilled_tactician
			trait = brilliant_strategist
		}
	}
	
	mean_time_to_happen = {
		days = 1
		modifier = {
			factor = 0.5
			trait = brave
		}
		modifier = {
			factor = 2.5
			trait = craven
		}
		modifier = {
			trait = genius
			factor = 0.5
		}
		modifier = {
			trait = quick
			factor = 0.5
		}	
		modifier = {
			trait = slow
			factor = 2
		}
		
		modifier = {
			trait = imbecile
			factor = 2
		}
		modifier = {
			trait = inbred
			factor = 2
		}
		modifier = {
			trait = strong
			factor = 0.5
		}
		modifier = {
			trait = weak
			factor = 2
		}	
		modifier = {
			factor = 2
			trait = stressed
		}
		modifier = {
			factor = 2
			trait = depressed
		}
		modifier = {
			factor = 2
			trait = lunatic
		}
		modifier = {
			factor = 2
			trait = possessed
		}
	}

	option = {
		name = "DAMN"
		if = {
			limit = {
				trait = brilliant_strategist
			}
			remove_trait = brilliant_strategist
			add_trait = skilled_tactician
		}
		if = {
			limit = {
				trait = skilled_tactician
			}
			remove_trait = skilled_tactician
			add_trait = tough_soldier
		}
		if = {
			limit = {
				trait = tough_soldier
			}
			remove_trait = tough_soldier
			add_trait = misguided_warrior
		}
	}
}


namespace = battle_charges

#Battle charge
character_event = {
	id = battle_charges.0
	desc = "EVTDESCbattle_charges.0"
	picture = GFX_evt_battle3
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		any_current_enemy = {
			at_location = ROOT
			in_command = yes
			NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
		}
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		in_command = yes
        in_battle = yes
		
		OR = {
	    	trait = skilled_tactician
	    	trait = brilliant_strategist
	    	martial = 12
		}
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.0"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2			
		}
		random = {
			chance = 50
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	option = {
		name = "EVTOPTBbattle_charges.0"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    75 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 15
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.05
                    morale = 0.2 
				}
			    25 = {
                    random = { chance = 15 death = { death_reason = death_battle } }
                    prestige = -100
                    troops = -0.3
                    morale = -0.3
				}
			}
		}
	}
}

#Battle charge 2
character_event = {
	id = battle_charges.1
	desc = "EVTDESCbattle_charges.1"
	picture = GFX_evt_battle2
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 12
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.1"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    } 
    }
	
	option = {
		name = "EVTOPTBbattle_charges.1"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    60 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 10
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.05
                    morale = 0.2 
				}
			    40 = {
                    random = { chance = 10 death = { death_reason = death_battle } }
                    prestige = -50
                    troops = -0.3
                    morale = -0.2
				}
			}
		}
	}
}

#Battle charge 3
character_event = {
	id = battle_charges.2
	desc = "EVTDESCbattle_charges.2"
	picture = GFX_evt_battle2
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 7
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.2"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.2"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    60 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 15
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.05
                    morale = 0.2
				}
			    40 = {
                    random = { chance = 10 death = { death_reason = death_battle } }
                    prestige = -50
                    troops = -0.3
                    morale = -0.2
				}
			}
		}
	}
}

#Battle charge 4
character_event = {
	id = battle_charges.3
	desc = "EVTDESCbattle_charges.3"
	picture = GFX_evt_battle3
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 10
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.3"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 50
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }

	option = {
		name = "EVTOPTBbattle_charges.3"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    75 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 5
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.15
                    morale = 0.25 
				}
			    25 = {
                    random = { chance = 15 death = { death_reason = death_battle } }
                    prestige = -100
                    troops = -0.4
                    morale = -0.3
				}
			}
		}
	}
}

#Battle charge 5
character_event = {
	id = battle_charges.4
	desc = "EVTDESCbattle_charges.4"
	picture = GFX_evt_orlando
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 12
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.4"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 50
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.4"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    75 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 15
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.25
                    morale = 0.3 
				}
			    25 = {
                    random = { chance = 15 death = { death_reason = death_battle } }
                    prestige = -100
                    troops = -0.75
                    morale = -0.3
				}
			}
		}
	}
}

#Battle charge 6
character_event = {
	id = battle_charges.5
	desc = "EVTDESCbattle_charges.3"
	picture = GFX_evt_orlando
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 6
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.3"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.3"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    60 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 10
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.15
                    morale = 0.3
				}
			    40 = {
                    random = { chance = 15 death = { death_reason = death_battle } }
                    prestige = -50
                    troops = -0.35
                    morale = -0.2
				}
			}
		}
	}
}

#Battle charge 7
character_event = {
	id = battle_charges.6
	desc = "EVTDESCbattle_charges.6"
	picture = GFX_evt_battle4
	border = GFX_event_normal_frame_war
	
	min_age = 14
	capable_only = yes
	prisoner = no
	is_triggered_only = yes


    trigger = {
		NOT = { trait = misguided_warrior }
		NOT = { trait = poor_warrior }
        NOT = { trait = craven }
        NOT = { trait = slothful }
		OR = { 
		    trait = skilled_tactician
		    trait = brilliant_strategist
		    martial = 8
		}
		in_command = yes
        in_battle = yes
	}

    mean_time_to_happen = {
		days = 1
        modifier = {
			factor = 0.25
			trait = craven
		}
        modifier = {
			factor = 0
			trait = squire
		}
        modifier = {
			factor = 2
			trait = knight
		}
        modifier = {
			factor = 0.25
			trait = slothful
		}
        modifier = {
			factor = 0.05
			trait = imbecile
		}
        modifier = {
			factor = 0.25
			trait = slow
		}
        modifier = {
			factor = 0.25
			trait = poor_warrior
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 7 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 9 }
		}
        modifier = {
			factor = 0.75
			NOT = { martial = 11 }
		}
        modifier = {
			factor = 1.25
			martial = 13
		}
        modifier = {
			factor = 1.25
			martial = 15
		}
        modifier = {
			factor = 1.25
			martial = 17
		}
        modifier = {
			factor = 1.25
			martial = 19
		}
        modifier = {
			factor = 1.25
			martial = 21
		}
		modifier = {
			factor = 1.25
			trait = brave
		}
		modifier = {
			factor = 1.15
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = brilliant_strategist
		}
		modifier = {
			factor = 1.15
			trait = skilled_warrior
		}
		modifier = {
			factor = 1.35
			trait = master_warrior
		}
		modifier = {
			factor = 1.5
			trait = machiavellian
		}
	}

	option = {
		name = "EVTOPTAbattle_charges.6"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.6"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLECHARGE
        hidden_tooltip = {
		    random_list = {
			    75 = {
		            any_current_enemy = {
		                limit = {
			                at_location = ROOT
			                in_command = yes
			                in_battle = yes
		 	                NOT = { any_current_enemy = { has_opinion_modifier = { who = PREV modifier = opinion_battle_duel_target } } }
			            }
			            hidden_tooltip = { 
	          		        random_list = { 
			                    25 = { character_event = { id = battle_charges.16 } }
	        		            25 = { character_event = { id = battle_charges.17 } }
			                    25 = { character_event = { id = battle_charges.18 } }
		                        25 = { character_event = { id = battle_charges.19 } }
			                } 
			            }
		            }
		            prestige = 50
				    add_trait = brave
				    hidden_tooltip = {
                        if = { 
				    	    limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 10
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
		            }
                    troops = 0.15
                    morale = 0.25 
				}
			    40 = {
                    random = { chance = 15 death = { death_reason = death_battle } }
                    prestige = -50
                    troops = -0.475
                    morale = -0.2
				}
			}
		}
	}
}

#Battle goes wrong 1
character_event = {

	id = battle_charges.16
	desc = "EVTDESCbattle_charges.16"

	is_triggered_only = yes
	picture = "GFX_evt_hastings"
	border = "GFX_event_normal_frame_war"

	trigger = {
        in_command = yes
        in_battle = yes
	}
	
	immediate = {
	    morale = -0.1
        troops = -0.25
        random = { chance = 15 death = { death_reason = death_battle killer = FROM } }
	}

	option = {
		name = "EVTOPTAbattle_charges.16"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2
            troops = -0.25 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.16"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLEFIGHTBACK
        hidden_tooltip = {
		    random_list = {
			    40 = {
		            prestige = 35
					add_trait = brave
				    hidden_tooltip = {
					    if = { 
					        limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 10
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
			        }
                    troops = 0.2
                    morale = 0.35 
		        }
		        60 = {
                    random = { chance = 30 death = { death_reason = death_battle killer = FROM } }
                    prestige = -25
                    troops = -0.55
                    morale = -0.3
				}
			}
		}
	}
	
	option = {
		name = "And so I die"
		trigger = { is_alive = no }
		prestige = -50
	}
}

#Battle goes wrong 2
character_event = {

	id = battle_charges.17
	desc = "EVTDESCbattle_charges.17"

	is_triggered_only = yes
	picture = "GFX_evt_battle3"
	border = "GFX_event_normal_frame_war"

	trigger = {
        in_command = yes
        in_battle = yes
	}

	immediate = {
	    morale = -0.1
        troops = -0.2
        random = { chance = 20 death = { death_reason = death_battle killer = FROM } }
	}

	option = {
		name = "EVTOPTAbattle_charges.17"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2
            troops = -0.25 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.17"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLEFIGHTBACK
        hidden_tooltip = {
		    random_list = {
		        30 = {
		            prestige = 35
					add_trait = brave
				    hidden_tooltip = {
					    if = { 
					        limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 10
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
			        }
                    troops = 0.25
                    morale = 0.45 
				}
			    70 = {
                    random = { chance = 20 death = { death_reason = death_battle killer = FROM } }
                    prestige = -25
                    troops = -0.5
                    morale = -0.2
				}
			}
		}
	}
	
	option = {
		name = "And so I die"
		trigger = { is_alive = no }
		prestige = -50
	}
}

#Battle goes wrong 3
character_event = {

	id = battle_charges.18
	desc = "EVTDESCbattle_charges.18"

	is_triggered_only = yes
	picture = "GFX_evt_battle2"
	border = "GFX_event_normal_frame_war"

	trigger = {
        in_command = yes
        in_battle = yes
	}
	
	immediate = {
	    morale = -0.1
        troops = -0.25
        random = { chance = 15 death = { death_reason = death_battle killer = FROM } }
	}

	option = {
		name = "EVTOPTAbattle_charges.18"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
	    	prestige = -15
            morale = -0.2
            troops = -0.25 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.18"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLEFIGHTBACK
        hidden_tooltip = {
		    random_list = {
			    50 = {
		            prestige = 50
					add_trait = brave
				    hidden_tooltip = {
					    if = { 
					        limit = { 
						        NOT = { trait = brave } 
						    } 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
						chance = 5
                        add_trait = war_hero
				        hidden_tooltip = {
					        if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
			        }    
                    troops = 0.2
                    morale = 0.35 
				}
			    50 = {
                    random = { chance = 20 death = { death_reason = death_battle killer = FROM } }
                    prestige = -25
                    troops = -0.6
                    morale = -0.3
				}
			}
		}
	}
	
	option = {
		name = "And so I die"
		trigger = { is_alive = no }
		prestige = -50
	}
}

#Battle goes wrong 4
character_event = {

	id = battle_charges.19
	desc = "EVTDESCbattle_charges.19"

	is_triggered_only = yes
	picture = "GFX_evt_battle4"
	border = "GFX_event_normal_frame_war"

	trigger = {
        in_command = yes
        in_battle = yes
	}
	
	immediate = {
	    morale = -0.1
        troops = -0.2
        random = { chance = 25 death = { death_reason = death_battle killer = FROM } }
	}

	option = {
		name = "EVTOPTAbattle_charges.19"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.25
				trait = brave
			}
			modifier = {
				factor = 1.5
				trait = slow
			}
			modifier = {
				factor = 2
				trait = imbecile
			}
			modifier = {
				factor = 1.75
				trait = humble
			}
			modifier = {
				factor = 5
				trait = craven
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = turncloak
			}
			modifier = {
				factor = 0.5
				trait = skilled_warrior
			}
			modifier = {
				factor = 0.5
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				trait = poor_warrior
			}
			modifier = {
				factor = 2
				trait = misguided_warrior
			}
			modifier = {
				factor = 3
				trait = deceitful
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		custom_tooltip = TOOLTIPBATTLERETREAT
		hidden_tooltip = {
		    prestige = -15
            morale = -0.2
            troops = -0.25 
		}
		random = {
			chance = 30
			add_trait = craven
			hidden_tooltip = {
				character_event = { id = 38257 }
		    }	
	    }
    }
	
	option = {
		name = "EVTOPTBbattle_charges.19"
		trigger = { is_alive = yes }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 5
				trait = brave
			}
			modifier = {
				factor = 2
				trait = brilliant_strategist
			}
			modifier = {
				factor = 1.5
				trait = skilled_tactician
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = machiavellian
			}
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = arbitrary
			}
			modifier = {
				factor = 0.25
				trait = turncloak
			}
			modifier = {
				factor = 2
				trait = skilled_warrior
			}
			modifier = {
				factor = 2
				trait = master_warrior
			}
			modifier = {
				factor = 0.75
				trait = trained_warrior
			}
			modifier = {
				factor = 0.5
				trait = poor_warrior
			}
			modifier = {
				factor = 0.25
				trait = misguided_warrior
			}
		}
		custom_tooltip = TOOLTIPBATTLEFIGHTBACK
        hidden_tooltip = {
		    random_list = {
			    40 = {
		            prestige = 50
					add_trait = brave
				    hidden_tooltip = {
					    if = { 
					        limit = { 
						        NOT = { trait = brave } 
					    	} 
					        character_event = {
						        id = 38270 #Notify Brave
					        }
					    }
				    }
                    random = { 
					    chance = 15
                        add_trait = war_hero
				        hidden_tooltip = {
				        	if = { 
					            limit = { 
						            NOT = { trait = war_hero } 
						        } 
					            character_event = {
						            id = tptt_traits.94 #Notify War Hero
					            }
					        }
				        }
			        }
                    troops = 0.2
                    morale = 0.45 
				}
			    60 = {
                    random = { chance = 20 death = { death_reason = death_battle killer = FROM } }
                    prestige = -25
                    troops = -0.45
                    morale = -0.2
				}
			}
		}
	}
	
	option = {
		name = "And so I die"
		trigger = { is_alive = no }
		prestige = -50
	}
}